# ๐ ุชูุซูู ูุดุฑูุน ูุธุงู ุชุณุฌูู ุงูุญุถูุฑ ุจู QR Code

## ๐ฏ ููุน ุงููุดุฑูุน
ูุธุงู ุชุณุฌูู ุญุถูุฑ ุฅููุชุฑููู ุจุงุณุชุฎุฏุงู QR Code ูุจูู ุจู **WPF (Windows Presentation Foundation)** ุจูุบุฉ **C#** ูุนูู ุนูู **.NET 8.0**.

---

## ๐ฆ ุงูููุชุจุงุช ุงููุณุชุฎุฏูุฉ (NuGet Packages)

| ุงูููุชุจุฉ | ุงูุฅุตุฏุงุฑ | ุงููุธููุฉ |
|---------|---------|---------|
| **MaterialDesignThemes** | 5.1.0 | ุชุตููู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุชุตููู Material Design ุงูุญุฏูุซ |
| **QRCoder** | 1.7.0 | ุชูููุฏ ุตูุฑ ุฑูุฒ QR |
| **System.Drawing.Common** | 10.0.1 | ุงูุชุนุงูู ูุน ุงูุตูุฑ ูุงูุฑุณููุงุช |

---

## ๐ ุฅุฌูุงูู ุงูุฅุญุตุงุฆูุงุช

- **ุนุฏุฏ ุงูููุงุณุงุช**: 5 ููุงุณุงุช
- **ุฅุฌูุงูู ุงูุฃุณุทุฑ**: ~1929 ุณุทุฑ
- **ุนุฏุฏ ุงูุฏูุงู**: 42+ ุฏุงูุฉ

---

## ๐๏ธ ุงูููุงุณุงุช ูุงููุณุคูููุงุช

### 1๏ธโฃ `MainWindow` 
**ุงูููู**: `MainWindow.xaml.cs` | **ุงูุฃุณุทุฑ**: 1619

ุงูููุงุณ ุงูุฑุฆูุณู ุงููุณุคูู ุนู:
- ุฅุฏุงุฑุฉ ุงูุณูุฑูุฑ HTTP/HTTPS
- ุฅุฏุงุฑุฉ ุฌูุณุงุช ุงููุญุงุถุฑุงุช
- ุชุณุฌูู ูุชุชุจุน ุงูุทูุงุจ
- ุชูููุฏ QR Codes
- ุชุตุฏูุฑ ุงูุจูุงูุงุช

#### ุงูุฏูุงู:

| ุงูุฏุงูุฉ | ุงููุธููุฉ |
|--------|---------|
| `MainWindow()` | ุชููุฆุฉ ุงูุชุทุจูู ูุงูู Timers |
| `BtnStart_Click()` | ุจุฏุก ุงูุณูุฑูุฑ ููุชุญ ูุงูุฐุฉ ุฅุนุฏุงุฏุงุช ุงูุฌูุณุฉ |
| `BtnStop_Click()` | ุฅููุงู ุงูุณูุฑูุฑ |
| `BtnExtend_Click()` | ุชูุฏูุฏ ููุช ุงูุฌูุณุฉ |
| `BtnEndLecture_Click()` | ุฅููุงุก ุงููุญุงุถุฑุฉ ูุจูุฑุงู |
| `BtnRefresh_Click()` | ุชุญุฏูุซ ูุงุฆูุฉ ุงูุทูุงุจ |
| `BtnLogoutAll_Click()` | ุชุณุฌูู ุฎุฑูุฌ ุฌููุน ุงูุทูุงุจ |
| `BtnExport_Click()` | ุชุตุฏูุฑ ุงูุจูุงูุงุช ูููู CSV |
| `BtnClear_Click()` | ูุณุญ ุฌููุน ุงูุจูุงูุงุช |
| `BtnMinimize_Click()` | ุชุตุบูุฑ ุงููุงูุฐุฉ |
| `BtnMaximize_Click()` | ุชูุจูุฑ ุงููุงูุฐุฉ |
| `BtnClose_Click()` | ุฅุบูุงู ุงูุชุทุจูู |
| `TitleBar_MouseDown()` | ุณุญุจ ุงููุงูุฐุฉ |
| `ImgQrLogin_Click()` | ูุชุญ QR ูู ูุงูุฐุฉ ูููุตูุฉ |
| `BtnDiscord_Click()` | ูุชุญ ุฑุงุจุท Discord |
| `BtnGitHub_Click()` | ูุชุญ ุฑุงุจุท GitHub |
| `StartServer()` | ุจุฏุก ุงูุณูุฑูุฑ HTTP/HTTPS |
| `StopServer()` | ุฅููุงู ุงูุณูุฑูุฑ |
| `ServerLoop()` | ุญููุฉ ุงุณุชูุจุงู ุงูุงุชุตุงูุงุช HTTP |
| `HttpsServerLoop()` | ุญููุฉ ุงุณุชูุจุงู ุงูุงุชุตุงูุงุช HTTPS |
| `HandleHttpsClient()` | ูุนุงูุฌุฉ ุงุชุตุงูุงุช HTTPS |
| `GenerateSelfSignedCertificate()` | ุฅูุดุงุก ุดูุงุฏุฉ SSL ุฐุงุชูุฉ ุงูุชูููุน |
| `HandleRequest()` | ูุนุงูุฌุฉ ุทูุจุงุช ุงูู HTTP |
| `RegisterStudent()` | ุชุณุฌูู ุทุงูุจ ุฌุฏูุฏ |
| `IsIpRegistered()` | ุงูุชุญูู ูู ุชุณุฌูู IP |
| `IsFingerprintRegistered()` | ุงูุชุญูู ูู ุจุตูุฉ ุงูุฌูุงุฒ |
| `LogoutStudent()` | ุชุณุฌูู ุฎุฑูุฌ ุทุงูุจ |
| `UpdateSessionState()` | ุชุญุฏูุซ ุญุงูุฉ ุงูุฌูุณุฉ |
| `GenerateQrBitmap()` | ุฅูุดุงุก ุตูุฑุฉ QR Code |
| `UpdateUiState()` | ุชุญุฏูุซ ุญุงูุฉ ุงููุงุฌูุฉ |
| `RefreshGrid()` | ุชุญุฏูุซ ุฌุฏูู ุงูุทูุงุจ |
| `TimerSession_Tick()` | ูุคูุช ุงูุฌูุณุฉ (ูู ุซุงููุฉ) |
| `TimerVisitors_Tick()` | ูุคูุช ุงูุฒูุงุฑ |
| `TrackVisitor()` | ุชุชุจุน ุงูุฒูุงุฑ ุงููุดุทูู |
| `GetLocalIPAddress()` | ุงูุญุตูู ุนูู ุนููุงู IP ุงููุญูู |
| `ParseUserAgent()` | ุชุญููู ููุน ุงูุฌูุงุฒ ูู User-Agent |
| `EscapeCsv()` | ุชููุฆุฉ ุงููุต ูููู CSV |
| `AddFirewallRule()` | ุฅุถุงูุฉ ูุงุนุฏุฉ Firewall |
| `GetStudentPage()` | ุฅูุดุงุก ุตูุญุฉ HTML ููุทุงูุจ |

#### ุงูุฃูุจุฌูุชุงุช:

| ุงูุฃูุจุฌูุช | ุงูููุน | ุงููุธููุฉ |
|----------|-------|---------|
| `_timerSession` | DispatcherTimer | ูุคูุช ุงูุฌูุณุฉ |
| `_timerVisitors` | DispatcherTimer | ูุคูุช ุชุชุจุน ุงูุฒูุงุฑ |
| `_listener` | TcpListener | ุงุณุชูุจุงู HTTP |
| `_listenerHttps` | TcpListener | ุงุณุชูุจุงู HTTPS |
| `_students` | List\<Student\> | ูุงุฆูุฉ ุงูุทูุงุจ ุงููุณุฌููู |
| `_visitors` | Dictionary | ูุงุฆูุฉ ุงูุฒูุงุฑ ุงููุดุทูู |
| `_currentSession` | SessionInfo | ูุนูููุงุช ุงูุฌูุณุฉ ุงูุญุงููุฉ |
| `_isServerRunning` | bool | ุญุงูุฉ ุชุดุบูู ุงูุณูุฑูุฑ |
| `_certificate` | X509Certificate2 | ุดูุงุฏุฉ SSL |

---

### 2๏ธโฃ `App`
**ุงูููู**: `App.xaml.cs` | **ุงูุฃุณุทุฑ**: 89

ููุงุณ ุฅุฏุงุฑุฉ ุงูุชุทุจูู ููุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุนุงูุฉ.

#### ุงูุฏูุงู:

| ุงูุฏุงูุฉ | ุงููุธููุฉ |
|--------|---------|
| `App()` | ุฑุจุท ูุนุงูุฌุงุช ุงูุฃุฎุทุงุก |
| `App_DispatcherUnhandledException()` | ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูู UI Thread |
| `CurrentDomain_UnhandledException()` | ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุญุฑุฌุฉ |
| `TaskScheduler_UnobservedTaskException()` | ูุนุงูุฌุฉ ุฃุฎุทุงุก ุงูู Tasks ุงูุฎูููุฉ |
| `GetErrorMessage()` | ุชูุณูู ุฑุณุงูุฉ ุงูุฎุทุฃ ููุนุฑุถ |

---

### 3๏ธโฃ `Student`
**ุงูููู**: `Student.cs` | **ุงูุฃุณุทุฑ**: 22

ูููุฐุฌ ุจูุงูุงุช ุงูุทุงูุจ (Data Model).

#### ุงูุฎุตุงุฆุต:

| ุงูุฎุงุตูุฉ | ุงูููุน | ุงููุธููุฉ |
|---------|-------|---------|
| `Id` | int | ุฑูู ุชุนุฑูู ุงูุทุงูุจ |
| `Index` | int | ููุฑุจุท ูุน DataGrid (Computed) |
| `Name` | string | ุงุณู ุงูุทุงูุจ |
| `Phone` | string | ุฑูู ุงููุงุชู |
| `DeviceType` | string | ููุน ุงูุฌูุงุฒ (Android/iOS/Desktop) |
| `IpAddress` | string | ุนููุงู IP ุงูุฎุงุต ุจุงูุฌูุงุฒ |
| `DeviceFingerprint` | string | ุจุตูุฉ ุงูุฌูุงุฒ ุงููุฑูุฏุฉ |
| `RegisterTime` | DateTime | ููุช ุชุณุฌูู ุงูุญุถูุฑ |
| `LogoutTime` | DateTime? | ููุช ุชุณุฌูู ุงูุฎุฑูุฌ |
| `LeftPageCount` | int | ุนุฏุฏ ูุฑุงุช ูุบุงุฏุฑุฉ ุงูุตูุญุฉ |
| `Status` | string | ุญุงูุฉ ุงูุทุงูุจ (Computed: Active/Left) |

---

### 4๏ธโฃ `SessionInfo`
**ุงูููู**: `SessionInfo.cs` | **ุงูุฃุณุทุฑ**: 31

ูููุฐุฌ ูุนูููุงุช ุงูุฌูุณุฉ/ุงููุญุงุถุฑุฉ.

#### ุงูุฎุตุงุฆุต:

| ุงูุฎุงุตูุฉ | ุงูููุน | ุงููุธููุฉ |
|---------|-------|---------|
| `Department` | string | ุงููุณู (ูุนูู ุญุงุณุจ ุขูู ุฅูุฌููุฒู) |
| `LoginDurationMinutes` | double | ูุฏุฉ ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฏูุงุฆู |
| `LectureDurationMinutes` | double | ูุฏุฉ ุงููุญุงุถุฑุฉ ุจุงูุฏูุงุฆู |
| `StartTime` | DateTime | ููุช ุจุฏุก ุงูุฌูุณุฉ |
| `Grade` | int | ุงููุฑูุฉ ุงูุฏุฑุงุณูุฉ (1-4) |
| `SessionId` | string | ูุนุฑู ูุฑูุฏ ููุฌูุณุฉ (8 ุฃุญุฑู) |
| `CreatedAt` | DateTime | ููุช ุฅูุดุงุก ุงูุฌูุณุฉ |
| `GradeString` | string | ุงุณู ุงููุฑูุฉ ุจุงูุนุฑุจู (Computed) |

---

### 5๏ธโฃ `SessionWindow`
**ุงูููู**: `SessionWindow.xaml.cs` | **ุงูุฃุณุทุฑ**: 102

ูุงูุฐุฉ ุญูุงุฑูุฉ ูุฅุนุฏุงุฏุงุช ุงูุฌูุณุฉ ุงูุฌุฏูุฏุฉ.

#### ุงูุฎุตุงุฆุต:

| ุงูุฎุงุตูุฉ | ุงูููุน | ุงููุธููุฉ |
|---------|-------|---------|
| `SelectedSession` | SessionInfo? | ุงูุฌูุณุฉ ุงููุญุฏุฏุฉ ุจุนุฏ ุงูุถุบุท ุนูู ุจุฏุก |

#### ุงูุฏูุงู:

| ุงูุฏุงูุฉ | ุงููุธููุฉ |
|--------|---------|
| `SessionWindow()` | ุชููุฆุฉ ุงููุงูุฐุฉ |
| `BtnStart_Click()` | ุงูุชุญูู ูู ุงูุจูุงูุงุช ูุฅูุดุงุก ุงูุฌูุณุฉ |
| `BtnCancel_Click()` | ุฅูุบุงุก ูุฅุบูุงู ุงููุงูุฐุฉ |
| `cmbGrade_SelectionChanged()` | ุญุฏุซ ุชุบููุฑ ุงููุฑูุฉ |

---

### 6๏ธโฃ `CustomMessageBox`
**ุงูููู**: `CustomMessageBox.xaml.cs` | **ุงูุฃุณุทุฑ**: 66

ุตูุฏูู ุฑุณุงุฆู ูุฎุตุต ุจุชุตููู Material Design.

#### ุงูุฎุตุงุฆุต:

| ุงูุฎุงุตูุฉ | ุงูููุน | ุงููุธููุฉ |
|---------|-------|---------|
| `Result` | MessageBoxResult | ูุชูุฌุฉ ุงุฎุชูุงุฑ ุงููุณุชุฎุฏู |

#### ุงูุฏูุงู:

| ุงูุฏุงูุฉ | ุงููุธููุฉ |
|--------|---------|
| `CustomMessageBox()` | ุชููุฆุฉ ุงูุตูุฏูู ูุถุจุท ุงููุธูุฑ |
| `Show()` | ุนุฑุถ ุงูุฑุณุงูุฉ (Static Method) |
| `BtnYes_Click()` | ูุนุงูุฌุฉ ุฒุฑ ูุนู |
| `BtnNo_Click()` | ูุนุงูุฌุฉ ุฒุฑ ูุง |
| `BtnOk_Click()` | ูุนุงูุฌุฉ ุฒุฑ ููุงูู |
| `BtnClose_Click()` | ูุนุงูุฌุฉ ุฒุฑ ุฅุบูุงู |

---

## ๐ ุทุฑููุฉ ุนูู ุงููุธุงู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     ูุณุงุฑ ุงูุนูู ุงูุฑุฆูุณู                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                             โ
โ  1. ุงููุญุงุถุฑ ููุชุญ ุงูุชุทุจูู                                    โ
โ           โ                                                  โ
โ  2. ูุถุบุท "ุจุฏุก" โ ุชุธูุฑ ูุงูุฐุฉ SessionWindow                   โ
โ           โ                                                  โ
โ  3. ูุฎุชุงุฑ ุงููุณูุ ุงููุฑูุฉุ ููุฏุฉ ุงูุฌูุณุฉ                        โ
โ           โ                                                  โ
โ  4. ุงูุณูุฑูุฑ ูุนูู ุนูู:                                       โ
โ     โข HTTP  โ Port 5000                                      โ
โ     โข HTTPS โ Port 5001                                      โ
โ           โ                                                  โ
โ  5. ูุธูุฑ QR Code ูุญุชูู ุนูู ุฑุงุจุท ุงูุตูุญุฉ                      โ
โ           โ                                                  โ
โ  6. ุงูุทูุงุจ ููุณุญูู QR ูููุชุญูู ุงูุตูุญุฉ                         โ
โ           โ                                                  โ
โ  7. ุงูุทุงูุจ ูุฏุฎู ุงุณูู ูุฑูู ูุงุชูู                             โ
โ           โ                                                  โ
โ  8. ุงููุธุงู ูุณุฌู: IPุ Device Fingerprintุ Device Type        โ
โ           โ                                                  โ
โ  9. ุงููุญุงุถุฑ ูุชุงุจุน ุงูุญุถูุฑ ูู ุงูุฌุฏูู                          โ
โ           โ                                                  โ
โ  10. ุจุนุฏ ุงูุชูุงุก ุงููุญุงุถุฑุฉ โ ุชุตุฏูุฑ CSV                         โ
โ                                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ููุฒุงุช ุงูุฃูุงู

1. **Device Fingerprint**: ุจุตูุฉ ูุฑูุฏุฉ ููู ุฌูุงุฒ ูููุน ุงูุชูุฑุงุฑ
2. **IP Tracking**: ุชุชุจุน ุนููุงู IP ููู ุทุงูุจ
3. **Page Leave Detection**: ุชุชุจุน ูุบุงุฏุฑุฉ ุงูุทุงูุจ ููุตูุญุฉ
4. **Self-Signed SSL**: ุชุดููุฑ ุงูุงุชุตุงู ุจุดูุงุฏุฉ ุฐุงุชูุฉ
5. **Firewall Rule**: ุฅุถุงูุฉ ูุงุนุฏุฉ ุชููุงุฆูุฉ ููู Windows Firewall

---

## ๐ ูููู ุงููููุงุช

```
AttendanceSystem/
โโโ App.xaml                    # ููุงุฑุฏ ุงูุชุทุจูู (Styles, Colors)
โโโ App.xaml.cs                 # ููุงุณ ุงูุชุทุจูู ุงูุฑุฆูุณู
โโโ MainWindow.xaml             # ูุงุฌูุฉ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
โโโ MainWindow.xaml.cs          # ููุฏ ุงููุงูุฐุฉ ุงูุฑุฆูุณูุฉ
โโโ SessionWindow.xaml          # ูุงุฌูุฉ ูุงูุฐุฉ ุงูุฌูุณุฉ
โโโ SessionWindow.xaml.cs       # ููุฏ ูุงูุฐุฉ ุงูุฌูุณุฉ
โโโ CustomMessageBox.xaml       # ูุงุฌูุฉ ุตูุฏูู ุงูุฑุณุงุฆู
โโโ CustomMessageBox.xaml.cs    # ููุฏ ุตูุฏูู ุงูุฑุณุงุฆู
โโโ Student.cs                  # ูููุฐุฌ ุงูุทุงูุจ
โโโ SessionInfo.cs              # ูููุฐุฌ ุงูุฌูุณุฉ
โโโ AttendanceSystem.csproj     # ุฅุนุฏุงุฏุงุช ุงููุดุฑูุน
โโโ app.manifest                # ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
```

---

## ๐ ููุงุญุธุงุช ุงููุทูุฑ

- ุงูุชุทุจูู ูุฏุนู ุงููุบุฉ ุงูุนุฑุจูุฉ ุจุงููุงูู
- ูุชุทูุจ ุตูุงุญูุงุช Administrator ูุฅุถุงูุฉ ููุงุนุฏ Firewall
- ูุนูู ุนูู .NET 8.0 Windows ููุท
- ูุณุชุฎุฏู Material Design ููุงุฌูุฉ ูุณุชุฎุฏู ุญุฏูุซุฉ

---

*ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุซูู ุชููุงุฆูุงู*
